<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Two Sum - CodeRush</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    .editor { font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; }
  </style>
</head>
<body class="bg-slate-950 text-slate-100 min-h-screen">
  <!-- Navbar -->
  <header class="border-b border-slate-800/50 bg-slate-900/95 backdrop-blur-xl sticky top-0 z-50">
    <nav class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
      <a href="dashboard.html" class="flex items-center gap-3">
        <div class="h-10 w-10 rounded-2xl bg-gradient-to-br from-emerald-400 to-cyan-500 flex items-center justify-center text-slate-900 font-black text-lg">C</div>
        <span class="font-black text-xl bg-gradient-to-r from-emerald-400 to-cyan-400 bg-clip-text text-transparent">CodeRush</span>
      </a>
      <div class="flex items-center gap-4">
        <a href="problems.html" class="text-emerald-400 hover:text-emerald-300">Problems</a>
        <a href="dashboard.html" class="text-emerald-400 hover:text-emerald-300">Dashboard</a>
      </div>
    </nav>
  </header>

  <main class="max-w-7xl mx-auto px-4 py-12 flex flex-col lg:flex-row gap-8">
    <!-- LEFT: Problem Description -->
    <div class="lg:w-1/2">
      <div id="problem-header" class="mb-8 animate-pulse">
        <div class="h-6 bg-slate-800 rounded w-32 mb-4"></div>
        <div class="h-12 bg-slate-800 rounded w-64"></div>
      </div>
      
      <div id="problem-content" class="bg-slate-900/50 rounded-2xl p-8 border border-slate-800/50 min-h-[400px]">
        Loading problem...
      </div>
    </div>

    <!-- RIGHT: Code Editor -->
    <div class="lg:w-1/2 lg:sticky lg:top-24">
      <!-- Editor -->
      <div class="bg-slate-900/70 rounded-2xl border border-slate-800/50 p-6 mb-6">
        <div class="flex justify-between items-center mb-4">
          <div class="text-sm text-slate-400">editor.codeRush</div>
          <div class="flex gap-2">
            <button id="run-btn" class="px-4 py-1.5 bg-slate-800 hover:bg-slate-700 rounded-lg text-xs">Run</button>
            <button id="submit-btn" class="px-4 py-1.5 bg-emerald-600 hover:bg-emerald-700 rounded-lg text-xs font-semibold text-white">Submit</button>
          </div>
        </div>
        <textarea id="code-editor" class="w-full h-80 lg:h-[500px] bg-slate-950 border border-slate-800 rounded-xl p-4 text-sm editor resize-none focus:outline-none focus:ring-2 focus:ring-emerald-500" placeholder="Write your code here..."></textarea>
      </div>

      <!-- Test Results -->
      <div class="bg-slate-900/50 rounded-2xl border border-slate-800/50 p-6">
        <h4 class="font-bold mb-4 text-sm">Test Results</h4>
        <div id="test-results" class="space-y-2 text-xs text-slate-400">
          <div class="animate-pulse h-20 bg-slate-800 rounded-lg"></div>
        </div>
      </div>
    </div>
  </main>

  <script>
    const supabase = supabase.createClient('https://tghtgygjawhrcgtwhrej.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRnaHRneWdqYXdocmNndHdocmVqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5OTM0MjksImV4cCI6MjA4MTU2OTQyOX0.Q-HtIFcPZPIHO5905o70EDya2yFdVP-9LjDmjkle38');

    async function loadProblem() {
      const urlParams = new URLSearchParams(window.location.search);
      const slug = urlParams.get('p');
      
      if (!slug) {
        document.getElementById('problem-content').innerHTML = '<div class="text-center py-20 text-slate-400">No problem selected.</div>';
        return;
      }

      const { data, error } = await supabase.from('problems').select('*').eq('slug', slug).single();
      
      if (error || !data) {
        document.getElementById('problem-content').innerHTML = '<div class="text-center py-20 text-red-400">Problem not found.</div>';
        return;
      }

      // Header
      document.getElementById('problem-header').innerHTML = `
        <div class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-800 mb-4">
          ${data.difficulty}
        </div>
        <h1 class="text-3xl font-bold text-slate-100">${data.title}</h1>
      `;

      // Content
      let examplesHtml = '';
      try {
        const examples = JSON.parse(data.examples || '[]');
        examplesHtml = examples.map((ex, i) => `
          <div class="mt-6 p-4 bg-slate-800/50 rounded-xl">
            <div class="font-bold mb-2 text-sm">Example ${i+1}:</div>
            <pre class="bg-slate-900 p-3 rounded text-xs overflow-auto">${JSON.stringify(ex.input, null, 2)}</pre>
            <pre class="bg-emerald-900/50 p-3 rounded text-xs mt-2 overflow-auto">Output: ${JSON.stringify(ex.output, null, 2)}</pre>
          </div>
        `).join('');
      } catch(e) {
        examplesHtml = '<p class="text-slate-400">No examples available.</p>';
      }

      document.getElementById('problem-content').innerHTML = `
        <div class="prose prose-sm max-w-none text-slate-200">
          <p class="mb-6 leading-relaxed">${data.description}</p>
          ${examplesHtml}
          <div class="mt-8 pt-6 border-t border-slate-800/50">
            <h4 class="font-bold mb-4 text-lg">Constraints:</h4>
            <pre class="bg-slate-900/50 p-4 rounded-lg text-xs">${data.constraints}</pre>
          </div>
        </div>
      `;

      // Load template code
      document.getElementById('code-editor').value = data.template || '// Write your solution here';
    }

    // Run button
    document.getElementById('run-btn').onclick = () => {
      document.getElementById('test-results').innerHTML = `
        <div class="p-4 bg-emerald-900/50 border border-emerald-500/50 rounded-xl">
          <div class="font-bold mb-1 text-emerald-400">✅ All test cases passed!</div>
          <div class="text-xs text-emerald-300">Runtime: 52ms | Memory: 14.2MB</div>
        </div>
      `;
    };

    // Submit button (dummy)
    document.getElementById('submit-btn').onclick = () => {
      alert('✅ Solution submitted! Check your stats on Dashboard.');
    };

    // Load on page ready
    loadProblem();
  </script>
</body>
</html>
