<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contest Result – CodeRush</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; }
  </style>
</head>

<body class="min-h-screen text-slate-100 bg-slate-950
             bg-[radial-gradient(circle_at_top,_rgba(45,212,191,0.23),_transparent_52%),radial-gradient(circle_at_bottom,_rgba(37,99,235,0.22),_transparent_55%)]">

<main class="max-w-4xl mx-auto px-4 py-6 mt-6 mb-10 bg-slate-900/85 border border-slate-800/60 rounded-2xl shadow-[0_0_40px_rgba(15,23,42,0.95)]">
  <div id="result-header" class="flex items-center justify-between mb-4">
    <!-- JS se fill hoga -->
  </div>

  <section id="leaderboard" class="mt-4 text-xs">
    <!-- JS se fill hoga -->
  </section>
</main>

<script src="contests-config.js"></script>
<script>
  function getContestIdFromUrl() {
    const params = new URLSearchParams(window.location.search);
    return params.get("contestId");
  }

  function findContestById(id) {
    return Array.isArray(CONTESTS) ? CONTESTS.find(c => c.id === id) : null;
  }

  // Abhi ke liye dummy leaderboard data (baad me Supabase se aayega)
  function getDummyLeaderboard(contestId) {
    // Example fixed data
    return [
      { rank: 1, name: "You", score: 300, time: "25:32" },
      { rank: 2, name: "Student B", score: 280, time: "27:10" },
      { rank: 3, name: "Student C", score: 260, time: "29:45" },
      { rank: 4, name: "Student D", score: 240, time: "32:05" },
      { rank: 5, name: "Student E", score: 220, time: "35:12" }
    ];
  }

  function renderHeader(contest) {
    const header = document.getElementById("result-header");
    if (!header) return;

    header.innerHTML = `
      <div>
        <p class="text-[11px] uppercase tracking-wide ${
          contest.type === "free" ? "text-emerald-400" : "text-amber-400"
        } mb-1">
          ${contest.type === "free" ? "Free contest" : "Paid contest"}
        </p>
        <h1 class="text-xl font-semibold mb-1">${contest.title} – Result</h1>
        <p class="text-slate-300 text-xs">
          Entry ${contest.entryFee === 0 ? "Free" : "₹" + contest.entryFee}
          • Total prize ₹${contest.totalPrize}
          • Top ${contest.maxWinners} students get rewards
        </p>
      </div>

      <button onclick="window.location.href='dashboard.html'"
        class="px-3 py-1.5 rounded-lg bg-emerald-500 text-slate-900 text-[11px] font-semibold">
        Back to dashboard
      </button>
    `;
  }

  function renderLeaderboard(contest) {
    const lb = document.getElementById("leaderboard");
    if (!lb) return;

    const rows = getDummyLeaderboard(contest.id)
      .map(row => `
        <tr class="border-t border-slate-800 hover:bg-slate-800/60">
          <td class="px-3 py-2 text-center">${row.rank}</td>
          <td class="px-3 py-2">${row.name}</td>
          <td class="px-3 py-2 text-center">${row.score}</td>
          <td class="px-3 py-2 text-center">${row.time}</td>
        </tr>
      `)
      .join("");

    lb.innerHTML = `
      <h2 class="text-sm font-semibold mb-2">Leaderboard (demo)</h2>
      <div class="border border-slate-800 rounded-xl overflow-hidden">
        <table class="w-full text-[11px]">
          <thead class="bg-slate-800/80 text-slate-300">
            <tr>
              <th class="px-3 py-2 text-left">Rank</th>
              <th class="px-3 py-2 text-left">Student</th>
              <th class="px-3 py-2 text-left">Score</th>
              <th class="px-3 py-2 text-left">Time</th>
            </tr>
          </thead>
          <tbody class="text-slate-200">
            ${rows}
          </tbody>
        </table>
      </div>
    `;
  }

  function initResultsPage() {
    const contestId = getContestIdFromUrl();
    const contest = findContestById(contestId);

    if (!contest) {
      document.body.innerHTML = `
        <div class="min-h-screen flex items-center justify-center bg-slate-950 text-slate-100">
          <div class="bg-slate-900 border border-slate-800 rounded-xl px-5 py-4 text-sm">
            <p class="text-red-400 font-semibold mb-2">Invalid contest.</p>
            <a href="dashboard.html" class="text-emerald-400 underline text-xs">Back to dashboard</a>
          </div>
        </div>
      `;
      return;
    }

    renderHeader(contest);
    renderLeaderboard(contest);
  }

  document.addEventListener("DOMContentLoaded", initResultsPage);
</script>

</body>
</html>
