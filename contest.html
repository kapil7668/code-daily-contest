<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contest - CodeRush</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <style>*{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;}</style>
</head>
<body class="min-h-screen text-slate-100 bg-slate-950 bg-[radial-gradient(circle_at_top,_rgba(45,212,191,0.23),_transparent_52%),radial-gradient(circle_at_bottom,_rgba(37,99,235,0.22),_transparent_55%)]">
  
<header class="border-b border-slate-800/60 bg-slate-950/80 backdrop-blur sticky top-0 z-30">
  <nav class="max-w-4xl mx-auto flex items-center justify-between px-4 py-3">
    <a href="dashboard.html" class="flex items-center gap-2">
      <div class="h-8 w-8 rounded-xl bg-gradient-to-br from-emerald-400 to-cyan-500 flex items-center justify-center text-slate-900 font-extrabold">C</div>
      <span class="font-semibold text-lg tracking-tight">CodeRush</span>
    </a>
    <a href="dashboard.html" class="px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-slate-900 font-semibold rounded-xl text-sm">‚Üê Back to Dashboard</a>
  </nav>
</header>

<main class="max-w-4xl mx-auto px-4 py-8 md:py-12">
  <div id="contest-details" class="bg-slate-900/75 border border-slate-800/60 rounded-3xl shadow-[0_0_40px_rgba(15,23,42,0.95)] p-8 md:p-12 mb-8 text-center">
    Loading contest...
  </div>

  <section class="bg-slate-900/80 border border-slate-800 rounded-3xl p-8">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-2xl font-bold bg-gradient-to-r from-emerald-400 to-cyan-400 bg-clip-text text-transparent">Live Leaderboard</h2>
      <div class="text-sm text-slate-400">Real-time ranking</div>
    </div>
    <div id="leaderboard" class="text-center py-12 text-slate-400">
      <div class="text-4xl mb-4">üèÜ</div>
      <p class="text-lg font-semibold">No participants yet!</p>
      <p class="text-sm mt-2">Be the first to join and get #1 rank</p>
    </div>
  </section>
</main>

<script>
const urlParams = new URLSearchParams(window.location.search);
const contestId = urlParams.get('id') || 'free-daily';
let globalContestId = contestId;
const CONTESTS = [
  { id: 'free-daily', name: 'Free Daily Rush', fee: 0, totalPrize: 1000, color: 'emerald', description: 'Min 100 participants ‚Ä¢ 1st wins ‚Çπ1000' },
  { id: 'free-mega', name: 'Free Mega Contest', fee: 0, totalPrize: 2500, color: 'cyan', description: 'Min 100 participants ‚Ä¢ 1st wins ‚Çπ2500' },
  { id: 'quick-9', name: '‚Çπ9 Quick Rush', fee: 9, totalPrize: 540, color: 'orange', description: 'Top 3 prizes ‚Ä¢ Min 100 participants' },
  { id: 'pro-49', name: '‚Çπ49 Pro Rush', fee: 49, totalPrize: 2940, color: 'amber', description: 'Top 10 prizes ‚Ä¢ Min 100 participants' },
  { id: 'elite-149', name: '‚Çπ149 Elite Rush', fee: 149, totalPrize: 13410, color: 'purple', description: 'Top 20 prizes ‚Ä¢ Min 150 participants' },
  { id: 'champion-199', name: '‚Çπ199 Champion', fee: 199, totalPrize: 23880, color: 'pink', description: 'Top 20 prizes ‚Ä¢ Min 200 participants' },
  { id: 'mega-99', name: '‚Çπ99 MEGA (Top 100)', fee: 99, totalPrize: 29700, color: 'indigo', description: 'Top 100 prizes ‚Ä¢ Min 500 participants' }
];

function loadContest() {
  const contest = CONTESTS.find(c => c.id === contestId);
  
  if (!contest) {
    document.getElementById('contest-details').innerHTML = '<h1 class="text-3xl font-bold text-red-400">Contest Not Found!</h1>';
    return;
  }
  
  document.title = contest.name + ' - CodeRush';
  
  const colorClass = contest.color === 'emerald' ? 'emerald' :
                    contest.color === 'cyan' ? 'cyan' :
                    contest.color === 'orange' ? 'orange' :
                    contest.color === 'amber' ? 'amber' :
                    contest.color === 'purple' ? 'purple' :
                    contest.color === 'pink' ? 'pink' : 'indigo';
  
  document.getElementById('contest-details').innerHTML = `
    <div class="mb-8">
      <div class="inline-flex items-center gap-2 bg-${colorClass}-500/20 border-2 border-${colorClass}-500/40 px-6 py-3 rounded-2xl mb-6 mx-auto w-fit">
        <div class="w-3 h-3 bg-${colorClass}-400 rounded-full animate-pulse"></div>
        <span class="text-sm font-bold text-${colorClass}-400 uppercase tracking-wider">LIVE</span>
      </div>
      <h1 class="text-4xl md:text-5xl font-black bg-gradient-to-r from-${colorClass}-400 to-${colorClass}-200 bg-clip-text text-transparent mb-4">${contest.name}</h1>
      <p class="text-xl text-slate-300 mb-8">${contest.description}</p>
    </div>
    
    <div class="grid md:grid-cols-3 gap-8">
      <div class="bg-slate-800/50 border border-slate-700 rounded-2xl p-6">
        <div class="text-3xl font-black text-emerald-400 mb-2">‚Çπ${contest.totalPrize.toLocaleString()}</div>
        <div class="text-slate-400 text-sm uppercase tracking-wide">Prize Pool</div>
      </div>
      <div class="bg-slate-800/50 border border-slate-700 rounded-2xl p-6">
        <div class="text-3xl font-bold text-${colorClass}-400 mb-2">${contest.fee===0?'FREE':'‚Çπ'+contest.fee}</div>
        <div class="text-slate-400 text-sm uppercase tracking-wide">Entry Fee</div>
      </div>
      <div class="bg-slate-800/50 border border-slate-700 rounded-2xl p-6">
        <button id="joinContest" class="w-full bg-gradient-to-r from-${colorClass}-500 to-${colorClass}-400 hover:from-${colorClass}-600 hover:to-${colorClass}-500 text-slate-900 font-black py-4 px-8 rounded-2xl text-lg shadow-2xl hover:-translate-y-1 transition-all duration-300">
          ${contest.fee===0?'‚úÖ Join Test Free':'üí≥ Pay ‚Çπ'+contest.fee+' & Join'}
        </button>
      </div>
    </div>
  `;
  
  document.getElementById('joinContest').onclick = () => {
    if (contest.fee === 0) {
      alert('‚úÖ Free contest joined! Starting exam...');
      window.location.href = `exam.html?contest=${globalContestId}`; 
    } else {
      const options = {
        key: 'rzp_test_Rxk6YiWLWxsTlb',
        amount: contest.fee * 100,
        currency: 'INR',
        name: 'CodeRush Contest',
        description: contest.name,
        handler: function (response) {
          alert('‚úÖ Payment Success! Contest joined!\nPayment ID: ' + response.razorpay_payment_id);
          window.location.href = `exam.html?contest=${globalContestId}`; 
          console.log('Redirecting to exam with contest:', globalContestId);
        },
        prefill: {
          name: 'Test User',
          email: 'test@example.com',
          contact: '9999999999'
        },
        theme: {
          color: '#10b981'
        }
      };
      const rzp = new Razorpay(options);
      rzp.open();
    }
  };
}

loadContest();
</script>
</body>
</html>
