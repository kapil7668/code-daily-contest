<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CodeRush â€“ Practice DSA, Contests & Interview Prep</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; }
    .glass { backdrop-filter: blur(20px); }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-slate-900/90 to-slate-950 text-slate-100 min-h-screen">
<!-- Navbar -->
<header class="border-b border-slate-800/50 bg-slate-900/95 glass sticky top-0 z-50 shadow-2xl">
  <nav class="max-w-7xl mx-auto flex items-center justify-between px-4 py-4 lg:px-8">
    <div class="flex items-center gap-3">
      <div class="h-12 w-12 rounded-2xl bg-gradient-to-br from-emerald-400 via-emerald-500 to-cyan-500 flex items-center justify-center text-slate-900 font-black text-xl shadow-2xl">
        C
      </div>
      <div>
        <span class="font-black text-2xl tracking-tight bg-gradient-to-r from-emerald-400 to-cyan-400 bg-clip-text text-transparent">
          CodeRush
        </span>
        <p class="text-xs text-emerald-400 font-medium tracking-wide">Practice â€¢ Compete â€¢ Win</p>
      </div>
    </div>

    <div class="hidden lg:flex items-center gap-8 text-sm font-medium">
      <a href="#problems" class="hover:text-emerald-400 transition-colors group">
        Problems<span class="block h-0.5 bg-emerald-400 scale-x-0 group-hover:scale-x-100 transition-transform origin-left mt-1"></span>
      </a>
      <a href="#home-contests-section" class="hover:text-emerald-400 transition-colors group">
        Contests<span class="block h-0.5 bg-emerald-400 scale-x-0 group-hover:scale-x-100 transition-transform origin-left mt-1"></span>
      </a>
      <a href="contests.html" class="hover:text-emerald-400 transition-colors group">
        Live Contests<span class="block h-0.5 bg-emerald-400 scale-x-0 group-hover:scale-x-100 transition-transform origin-left mt-1"></span>
      </a>
    </div>

    <div class="flex items-center gap-3">
      <button id="open-login" class="text-sm px-6 py-2.5 rounded-xl border-2 border-slate-700/50 hover:border-emerald-400/70 hover:text-emerald-300 hover:bg-emerald-500/5 backdrop-blur-sm transition-all duration-300">
        Sign in
      </button>
      <button id="open-signup" class="text-sm px-8 py-2.5 rounded-xl bg-gradient-to-r from-emerald-500 to-emerald-400 hover:from-emerald-600 hover:to-emerald-500 text-slate-900 font-bold shadow-xl hover:shadow-emerald-500/25 transition-all duration-300 transform hover:-translate-y-0.5">
        Start Free
      </button>
    </div>
  </nav>
</header>

<!-- Hero Section -->
<main class="max-w-7xl mx-auto px-4 py-20 lg:py-32">
  <section class="grid lg:grid-cols-2 gap-12 lg:gap-20 items-center">
    <div class="space-y-8">
      <div class="inline-flex items-center gap-3 px-4 py-2 bg-emerald-500/10 border border-emerald-400/30 rounded-full text-sm font-bold text-emerald-300 backdrop-blur-sm">
        <div class="w-2 h-2 bg-emerald-400 rounded-full animate-pulse"></div>
        ðŸš€ Daily coding made simple
      </div>
      
      <h1 class="text-5xl lg:text-7xl font-black leading-[0.9] bg-gradient-to-r from-slate-100 via-slate-200 to-slate-300 bg-clip-text text-transparent">
        Practice <span class="text-transparent bg-gradient-to-r from-emerald-400 via-emerald-500 to-cyan-500 bg-clip-text">DSA</span><br>
        <span class="text-4xl lg:text-6xl">Compete in Contests</span>
      </h1>
      <p class="text-xl text-slate-300 max-w-lg leading-relaxed">
        Solve 4,000+ curated problems. Join daily contests, win prizes, get interview-ready.
      </p>
      <div class="flex flex-col sm:flex-row gap-4">
        <button id="cta-start" class="group px-8 py-4 rounded-2xl bg-gradient-to-r from-emerald-500 to-emerald-400 hover:from-emerald-600 hover:to-emerald-500 text-slate-900 font-bold text-lg shadow-2xl hover:shadow-emerald-500/50 transition-all duration-300 transform hover:-translate-y-1 flex items-center gap-2">
          <span>Start Coding Now</span>
          <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
          </svg>
        </button>
        <button class="px-8 py-4 rounded-2xl border-2 border-slate-700/50 text-lg backdrop-blur-sm hover:border-emerald-400/70 hover:bg-emerald-500/5 transition-all duration-300 flex items-center gap-2" onclick="document.getElementById('home-contests-section').scrollIntoView({behavior:'smooth'})">
          <span>Upcoming Contests</span>
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </button>
      </div>
    </div>

    <!-- Stats Cards -->
    <div class="lg:ml-auto">
      <div class="bg-slate-900/50 border border-slate-800/50 backdrop-blur-xl rounded-3xl p-8 shadow-2xl shadow-slate-900/50">
        <p class="text-lg font-bold text-slate-300 mb-8">Today's Snapshot</p>
        <div class="grid grid-cols-3 gap-4 mb-8">
          <div class="group bg-gradient-to-br from-emerald-500/10 to-emerald-400/10 border border-emerald-500/20 rounded-2xl p-5 backdrop-blur-sm hover:bg-emerald-500/20 transition-all">
            <p class="text-slate-400 text-sm mb-1">Problems</p>
            <p class="text-3xl font-black text-emerald-400">4,500+</p>
          </div>
          <div class="group bg-gradient-to-br from-cyan-500/10 to-cyan-400/10 border border-cyan-500/20 rounded-2xl p-5 backdrop-blur-sm hover:bg-cyan-500/20 transition-all">
            <p class="text-slate-400 text-sm mb-1">Languages</p>
            <p class="text-3xl font-black text-cyan-400">C++/Java/Python</p>
          </div>
          <div class="group bg-gradient-to-br from-amber-500/10 to-amber-400/10 border border-amber-500/20 rounded-2xl p-5 backdrop-blur-sm hover:bg-amber-500/20 transition-all">
            <p class="text-slate-400 text-sm mb-1">Contests</p>
            <p class="text-3xl font-black text-amber-400">Daily + Weekly</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Active Contests Section -->
  <section id="home-contests-section" class="mt-16">
    <div class="flex items-center justify-between mb-4">
      <div>
        <h2 class="text-2xl lg:text-3xl font-black text-slate-50">Active contests</h2>
        <p class="text-sm text-slate-400 mt-1">Join anytime â€¢ Results after minimum participants</p>
      </div>
      <a href="contests.html" class="text-sm text-cyan-300 hover:underline">View all contests</a>
    </div>
    <div id="home-contests" class="grid gap-5 md:grid-cols-2 xl:grid-cols-3"></div>
  </section>
</main>
<!-- Auth Modal -->
<div id="auth-modal" class="fixed inset-0 bg-black/80 backdrop-blur-2xl flex items-center justify-center px-4 z-50 hidden">
  <div class="bg-slate-900/95 border border-slate-800/50 backdrop-blur-3xl rounded-3xl w-full max-w-md shadow-2xl">
    <div class="flex items-center justify-between px-6 py-6 border-b border-slate-800/50">
      <h2 class="text-2xl font-black text-slate-100" id="auth-title">Sign in to CodeRush</h2>
      <button id="close-auth" class="text-slate-400 hover:text-slate-100 text-2xl p-2 rounded-xl hover:bg-slate-800/50">&times;</button>
    </div>
    <div class="px-6 pt-6 pb-8">
      <div class="flex mb-8 border border-slate-800/50 rounded-2xl overflow-hidden">
        <button id="tab-login" class="flex-1 py-3.5 bg-slate-800/70 text-emerald-400">Login</button>
        <button id="tab-signup" class="flex-1 py-3.5 text-slate-400">Sign up</button>
      </div>
      <form id="auth-form" class="space-y-5">
        <input id="auth-email" type="email" required placeholder="you@example.com" class="w-full rounded-2xl bg-slate-900/50 border border-slate-700/50 px-5 py-4 text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 placeholder:text-slate-500" />
        <input id="auth-password" type="password" required placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" class="w-full rounded-2xl bg-slate-900/50 border border-slate-700/50 px-5 py-4 text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 placeholder:text-slate-500" />
        
        <div id="signup-extra" class="space-y-4 hidden">
          <input id="auth-name" type="text" placeholder="Your name" class="w-full rounded-2xl bg-slate-900/50 border border-slate-700/50 px-5 py-3 text-sm focus:ring-emerald-500 placeholder:text-slate-500" />
          <input id="auth-phone" type="tel" placeholder="10-digit mobile" class="w-full rounded-2xl bg-slate-900/50 border border-slate-700/50 px-5 py-3 text-sm focus:ring-emerald-500 placeholder:text-slate-500" />
        </div>
        
        <button type="submit" id="submit-btn" class="w-full rounded-2xl bg-gradient-to-r from-emerald-500 to-emerald-400 hover:from-emerald-600 text-slate-900 font-bold py-4 text-lg shadow-xl flex items-center justify-center gap-2 disabled:opacity-50">
          <span id="submit-text">Continue</span>
          <div id="loading-spinner" class="w-5 h-5 border-2 border-slate-900 border-t-emerald-400 rounded-full animate-spin hidden"></div>
        </button>
      </form>
    </div>
  </div>
</div>

<!-- FIXED SUPABASE + AUTH -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js"></script>
<script>
const SUPABASE_URL = 'https://tghtgygjawhrcgtwhrej.supabase.co';
const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRnaHRneWdqYXdocmNndHdocmVqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5OTM0MjksImV4cCI6MjA4MTU2OTQyOX0.Q-Ht_IFcPZPIHO5905o70EDya2yFdVP-9LjDmjkle38';

// âœ… FIXED: Proper Supabase init
const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
  auth: { autoRefreshToken: true, persistSession: true, detectSessionInUrl: true }
});

// âœ… FIXED: Auth check - NO ERRORS
async function checkAuth() {
  try {
    const { data: { user } } = await supabase.auth.getUser();
    if (user) window.location.href = 'dashboard.html';
  } catch (e) { console.log('Not logged in'); }
}

// âœ… FIXED: Contest handler
async function handleContestCTA(type, amount = 0, variant = '') {
  const { data: { user } } = await supabase.auth.getUser();
  if (!user) {
    window.targetContest = { type, amount, variant };
    openModal('signup'); return;
  }
  const params = type === 'free' ? 'type=free' : `type=paid&amount=${amount}`;
  window.location.href = `contest.html?${params}`;
}

// Modal logic
let currentMode = 'login';
const modal = document.getElementById('auth-modal');
const form = document.getElementById('auth-form');

function openModal(mode = 'login') {
  currentMode = mode;
  document.body.style.overflow = 'hidden';
  modal.classList.remove('hidden');
  document.getElementById('auth-email').focus();
}

function closeModal() {
  document.body.style.overflow = '';
  modal.classList.add('hidden');
  form.reset();
}

// Event listeners
document.getElementById('open-login')?.onclick = () => openModal('login');
document.getElementById('open-signup')?.onclick = () => openModal('signup');
document.getElementById('cta-start')?.onclick = () => openModal('signup');
document.getElementById('close-auth')?.onclick = closeModal;

document.getElementById('tab-login')?.onclick = () => currentMode = 'login';
document.getElementById('tab-signup')?.onclick = () => currentMode = 'signup';

form.onsubmit = async (e) => {
  e.preventDefault();
  const email = document.getElementById('auth-email').value;
  const password = document.getElementById('auth-password').value;
  const name = document.getElementById('auth-name')?.value || '';
  const phone = document.getElementById('auth-phone')?.value || '';

  const submitBtn = document.getElementById('submit-btn');
  const submitText = document.getElementById('submit-text');
  const spinner = document.getElementById('loading-spinner');
  
  submitBtn.disabled = true;
  submitText.classList.add('hidden');
  spinner.classList.remove('hidden');

  try {
    if (currentMode === 'signup') {
      const { error } = await supabase.auth.signUp({ email, password });
      if (error) throw error;
    } else {
      const { error } = await supabase.auth.signInWithPassword({ email, password });
      if (error) throw error;
    }
    setTimeout(() => window.location.href = 'dashboard.html', 1000);
  } catch (error) {
    alert(error.message);
  } finally {
    submitBtn.disabled = false;
    submitText.classList.remove('hidden');
    spinner.classList.add('hidden');
  }
};

// Init
document.addEventListener('DOMContentLoaded', checkAuth);
window.handleContestCTA = handleContestCTA;
</script>
</body>
</html>
