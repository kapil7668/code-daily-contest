<!DOCTYPE html>
<html>
<head><title>CodeRush Admin</title></head>
<body style="font-family:monospace;padding:20px;background:#1e1e1e;color:white;">
    <h1>ðŸš€ CodeRush Question Manager</h1>
    <div style="display:flex;gap:20px;">
        <!-- ADD NEW QUESTION -->
        <div style="flex:1;background:#21262d;padding:20px;border-radius:10px;">
            <h2>Add Question</h2>
            <input id="qtitle" placeholder="Title (Two Sum)" style="width:100%;padding:10px;margin:5px 0;">
            <input id="qdiff" placeholder="Easy/Medium/Hard" style="width:100%;padding:10px;margin:5px 0;">
            <textarea id="qdesc" placeholder="Description..." rows=3 style="width:100%;padding:10px;margin:5px 0;"></textarea>
            <textarea id="qtests" placeholder='[[[2,7,11,15],9,[0,1]], [[3,2,4],6,[1,2]]]' rows=3 style="width:100%;padding:10px;margin:5px 0;"></textarea>
            <textarea id="qtemplate" placeholder="function twoSum(nums,target)" rows=3 style="width:100%;padding:10px;margin:5px 0;"></textarea>
            <select id="qcontest" style="width:100%;padding:10px;margin:5px 0;">
                <option value="free-daily">free-daily (1 winner)</option>
                <option value="free-mega">free-mega (1 winner)</option>
                <option value="quick-9">quick-9 (Top 3)</option>
                <option value="pro-49">pro-49 (Top 10)</option>
                <option value="advanced-99">advanced-99 (Top 100)</option>
                <option value="elite-149">elite-149 (Top 20)</option>
                <option value="champion-199">champion-199 (Top 20)</option>
            </select>
            <button onclick="addQuestion()" style="width:100%;padding:12px;background:#238636;color:white;border:none;border-radius:6px;font-size:16px;cursor:pointer;">âž• ADD QUESTION</button>
        </div>
        
        <!-- CONTESTS LIST -->
        <div style="flex:2;background:#21262d;padding:20px;border-radius:10px;">
            <h2>Contests (Questions Count)</h2>
            <div id="contests"></div>
        </div>
    </div>

    <script>
        let questions = {};
        loadQuestions();

        async function loadQuestions() {
            try {
                const res = await fetch('questions.json');
                questions = await res.json();
                showContests();
            } catch(e) {
                questions = {}; // Empty if no file
            }
        }

        function showContests() {
            const contests = document.getElementById('contests');
            contests.innerHTML = Object.keys(questions).map(id=>{
                const count = questions[id].length;
                return `
                    <div style="background:#1e1e1e;padding:15px;margin:10px 0;border-radius:6px;border-left:4px solid #58a6ff;">
                        <strong>${id.toUpperCase()} (${count} questions)</strong>
                        <div style="margin-top:10px;font-size:12px;color:#8b949e;">
                            ${questions[id].map(q=>q.title).join(', ')}
                        </div>
                        <button onclick="editContest('${id}')" style="margin-top:10px;padding:6px 12px;background:#7c3aed;color:white;border:none;border-radius:4px;cursor:pointer;font-size:12px;">Edit</button>
                        <button onclick="downloadJSON()" style="margin-left:10px;padding:6px 12px;background:#f85149;color:white;border:none;border-radius:4px;cursor:pointer;font-size:12px;">ðŸ’¾ Save All</button>
                    </div>
                `;
            }).join('');
            if(Object.keys(questions).length===0) {
                contests.innerHTML = '<div style="color:#8b949e;">No contests yet. Add your first question!</div>';
            }
        }

        function addQuestion() {
            const title = document.getElementById('qtitle').value;
            const diff = document.getElementById('qdiff').value;
            const desc = document.getElementById('qdesc').value;
            const tests = document.getElementById('qtests').value;
            const template = document.getElementById('qtemplate').value;
            const contest = document.getElementById('qcontest').value;

            if(!title || !tests) return alert('Title and Tests required!');

            if(!questions[contest]) questions[contest] = [];
            questions[contest].push({
                title, difficulty:diff, desc,
                tests: JSON.parse(tests),
                template
            });

            document.getElementById('qtitle').value = '';
            document.getElementById('qdiff').value = '';
            document.getElementById('qdesc').value = '';
            document.getElementById('qtests').value = '';
            document.getElementById('qtemplate').value = '';
            
            showContests();
            alert('âœ… Question added to ' + contest);
        }

        function editContest(id) {
            alert('Edit mode: questions.json manually edit ' + id + ' array');
        }

        async function downloadJSON() {
            const dataStr = JSON.stringify(questions, null, 2);
            const dataBlob = new Blob([dataStr], {type:'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'questions.json';
            link.click();
        }
    </script>
</body>
</html>
